---
title: "Assignment2"
output: html_document
date: "2022-10-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Assignment 2
Second Assignment:
Creating a function to generate mixed Normal fitst

```{r}
rmixnorm <- function(N, mu1, mu2, sigma1, sigma2, tau){
  ind <- I(runif(N) > tau)
  X <- rep(0,N)
  X[ind] <- rnorm(sum(ind), mu1, sigma1)
  X[!ind] <- rnorm(sum(!ind), mu2, sigma2)
  return(X)
}

dmixnorm <- function(x, mu1, mu2, sigma1, sigma2, tau){
  y <- (1-tau)*dnorm(x,mu1,sigma1) + tau*dnorm(x,mu2,sigma2)
  return(y)
}

```
Setting parameters
```{r}

mu1 <- 3
mu2 <- 0
sigma1 <- 0.5
sigma2 <- 1
tau <- 0.6

x <- rmixnorm(100, mu1, mu2, sigma1, sigma2, tau)

```
Define distance between 2 distributions
```{r}

distance <- function(samples, kernel, h){
  kde_df <- density(samples, kernel=kernel, bw=h)
  
  new_x <- kde_df$x
  kde_pdf <- kde_df$y
  mix_pdf <- dmixnorm(new_x, mu1, mu2, sigma1, sigma2, tau)
  
  dist <- sqrt(sum((kde_pdf-mix_pdf)^2))
  return(dist)
}
```
Now, we will do loops to store the results:

```{r}
kernels <- c()
hs <- c()
mean_ds <- c()

for (kernel in c('gaussian', 'epanechnikov', 'rectangular')){
  for (h in seq(0.1, 0.9, by=0.05)){
    kernels <- append(kernels, kernel)
    hs <- append(hs, h)
    
    mean_d = c()
    for (i in 1:200){
      X <- rmixnorm(100, mu1, mu2, sigma1, sigma2, tau)
      d <- distance(X, kernel, h)
      
      mean_d <- append(mean_d, d)
    }
    mean_d <- mean(mean_d)
    
    mean_ds <- append(mean_ds, mean_d)
  }
}
```
We will create df to plot the data
```{r}
df <- data.frame(Kernel <- kernels, bandwidth <- hs, distance <- mean_ds)

```

## Including Plots
Plots and explore.
In the plot, the 3 kernels achieve lowest at bandwidth at about bandwidth = 0.35 or 0.4
The Gaussian Kernel and Epanechnikov seem to achieve lower distance overall. The most efficient measurements are the pairs (Gaussian, 0.4) and (Epanechnikov, 0.35). The Gaussian bandwidth seems to have high error at the first few values of bandwidths, but it seems to fit fine with the values later. This can be due to the data are generated by Gaussian.

```{r , echo=FALSE}
library(ggplot2)

ggplot(data=df, mapping=aes(x=bandwidth, y=distance, color=Kernel)) + geom_point(size=2) 
```

